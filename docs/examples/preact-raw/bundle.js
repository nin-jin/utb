!function(){"use strict";function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}function o(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function n(t,e){for(var o in e)t[o]=e[o];return t}function r(t){!t._dirty&&(t._dirty=!0)&&1==D.push(t)&&(N.debounceRendering||E)(i)}function i(){var t,e=D;for(D=[];t=e.pop();)t._dirty&&b(t)}function l(t,e,o){return"string"==typeof e||"number"==typeof e?void 0!==t.splitText:"string"==typeof e.nodeName?!t._componentConstructor&&a(t,e.nodeName):o||t._componentConstructor===e.nodeName}function a(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function s(t){var e=n({},t.attributes);e.children=t.children;var o=t.nodeName.defaultProps;if(void 0!==o)for(var r in o)void 0===e[r]&&(e[r]=o[r]);return e}function u(t){var e=t.parentNode;e&&e.removeChild(t)}function c(t,e,o,n,r){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)o&&o(null),n&&n(t);else if("class"!==e||r)if("style"===e){if(n&&"string"!=typeof n&&"string"!=typeof o||(t.style.cssText=n||""),n&&"object"==typeof n){if("string"!=typeof o)for(var i in o)i in n||(t.style[i]="");for(var i in n)t.style[i]="number"==typeof n[i]&&!1===U.test(i)?n[i]+"px":n[i]}}else if("dangerouslySetInnerHTML"===e)n&&(t.innerHTML=n.__html||"");else if("o"==e[0]&&"n"==e[1]){var l=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),n?o||t.addEventListener(e,d,l):t.removeEventListener(e,d,l),(t._listeners||(t._listeners={}))[e]=n}else if("list"!==e&&"type"!==e&&!r&&e in t)!function(t,e,o){try{t[e]=o}catch(t){}}(t,e,null==n?"":n),null!=n&&!1!==n||t.removeAttribute(e);else{var a=r&&e!==(e=e.replace(/^xlink\:?/,""));null==n||!1===n?a?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof n&&(a?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),n):t.setAttribute(e,n))}else t.className=n||""}function d(t){return this._listeners[t.type](N.event&&N.event(t)||t)}function p(){for(var t;t=A.pop();)N.afterMount&&N.afterMount(t),t.componentDidMount&&t.componentDidMount()}function f(t,e,o,n,r,i){B++||(L=null!=r&&void 0!==r.ownerSVGElement,P=null!=t&&!("__preactattr_"in t));var l=h(t,e,o,n,i);return r&&l.parentNode!==r&&r.appendChild(l),--B||(P=!1,i||p()),l}function h(t,e,o,n,r){var i=t,d=L;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||r)?t.nodeValue!=e&&(t.nodeValue=e):(i=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(i,t),m(t,!0))),i.__preactattr_=!0,i;var p=e.nodeName;if("function"==typeof p)return function(t,e,o,n){var r=t&&t._component,i=r,l=t,a=r&&t._componentConstructor===e.nodeName,u=a,c=s(e);for(;r&&!u&&(r=r._parentComponent);)u=r.constructor===e.nodeName;r&&u&&(!n||r._component)?(g(r,c,3,o,n),t=r.base):(i&&!a&&(C(i),t=l=null),r=_(e.nodeName,c,o),t&&!r.nextBase&&(r.nextBase=t,l=null),g(r,c,1,o,n),t=r.base,l&&t!==l&&(l._component=null,m(l,!1)));return t}(t,e,o,n);if(L="svg"===p||"foreignObject"!==p&&L,p=String(p),(!t||!a(t,p))&&(i=function(t,e){var o=e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);return o.normalizedNodeName=t,o}(p,L),t)){for(;t.firstChild;)i.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(i,t),m(t,!0)}var f=i.firstChild,v=i.__preactattr_,y=e.children;if(null==v){v=i.__preactattr_={};for(var b=i.attributes,w=b.length;w--;)v[b[w].name]=b[w].value}return!P&&y&&1===y.length&&"string"==typeof y[0]&&null!=f&&void 0!==f.splitText&&null==f.nextSibling?f.nodeValue!=y[0]&&(f.nodeValue=y[0]):(y&&y.length||null!=f)&&function(t,e,o,n,r){var i,a,s,c,d,p=t.childNodes,f=[],v={},_=0,y=0,g=p.length,b=0,C=e?e.length:0;if(0!==g)for(var w=0;w<g;w++){var x=p[w],T=x.__preactattr_,k=C&&T?x._component?x._component.__key:T.key:null;null!=k?(_++,v[k]=x):(T||(void 0!==x.splitText?!r||x.nodeValue.trim():r))&&(f[b++]=x)}if(0!==C)for(var w=0;w<C;w++){c=e[w],d=null;var k=c.key;if(null!=k)_&&void 0!==v[k]&&(d=v[k],v[k]=void 0,_--);else if(!d&&y<b)for(i=y;i<b;i++)if(void 0!==f[i]&&l(a=f[i],c,r)){d=a,f[i]=void 0,i===b-1&&b--,i===y&&y++;break}d=h(d,c,o,n),s=p[w],d&&d!==t&&d!==s&&(null==s?t.appendChild(d):d===s.nextSibling?u(s):t.insertBefore(d,s))}if(_)for(var w in v)void 0!==v[w]&&m(v[w],!1);for(;y<=b;)void 0!==(d=f[b--])&&m(d,!1)}(i,y,o,n,P||null!=v.dangerouslySetInnerHTML),function(t,e,o){var n;for(n in o)e&&null!=e[n]||null==o[n]||c(t,n,o[n],o[n]=void 0,L);for(n in e)"children"===n||"innerHTML"===n||n in o&&e[n]===("value"===n||"checked"===n?t[n]:o[n])||c(t,n,o[n],o[n]=e[n],L)}(i,e.attributes,v),L=d,i}function m(t,e){var o=t._component;o?C(o):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||u(t),v(t))}function v(t){for(t=t.lastChild;t;){var e=t.previousSibling;m(t,!0),t=e}}function _(t,e,o){var n,r=M[t.name];if(t.prototype&&t.prototype.render?(n=new t(e,o),w.call(n,e,o)):((n=new w(e,o)).constructor=t,n.render=y),r)for(var i=r.length;i--;)if(r[i].constructor===t){n.nextBase=r[i].nextBase,r.splice(i,1);break}return n}function y(t,e,o){return this.constructor(t,o)}function g(t,e,o,n,i){t._disable||(t._disable=!0,(t.__ref=e.ref)&&delete e.ref,(t.__key=e.key)&&delete e.key,!t.base||i?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,n),n&&n!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=n),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==o&&(1!==o&&!1===N.syncComponentUpdates&&t.base?r(t):b(t,1,i)),t.__ref&&t.__ref(t))}function b(t,e,o,r){if(!t._disable){var i,l,a,u=t.props,c=t.state,d=t.context,h=t.prevProps||u,v=t.prevState||c,y=t.prevContext||d,w=t.base,x=t.nextBase,T=w||x,k=t._component,S=!1;if(w&&(t.props=h,t.state=v,t.context=y,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(u,c,d)?S=!0:t.componentWillUpdate&&t.componentWillUpdate(u,c,d),t.props=u,t.state=c,t.context=d),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!S){i=t.render(u,c,d),t.getChildContext&&(d=n(n({},d),t.getChildContext()));var I,E,U=i&&i.nodeName;if("function"==typeof U){var D=s(i);(l=k)&&l.constructor===U&&D.key==l.__key?g(l,D,1,d,!1):(I=l,t._component=l=_(U,D,d),l.nextBase=l.nextBase||x,l._parentComponent=t,g(l,D,0,d,!1),b(l,1,o,!0)),E=l.base}else a=T,(I=k)&&(a=t._component=null),(T||1===e)&&(a&&(a._component=null),E=f(a,i,d,o||!w,T&&T.parentNode,!0));if(T&&E!==T&&l!==k){var L=T.parentNode;L&&E!==L&&(L.replaceChild(E,T),I||(T._component=null,m(T,!1)))}if(I&&C(I),t.base=E,E&&!r){for(var P=t,M=t;M=M._parentComponent;)(P=M).base=E;E._component=P,E._componentConstructor=P.constructor}}if(!w||o?A.unshift(t):S||(t.componentDidUpdate&&t.componentDidUpdate(h,v,y),N.afterUpdate&&N.afterUpdate(t)),null!=t._renderCallbacks)for(;t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);B||r||p()}}function C(t){N.beforeUnmount&&N.beforeUnmount(t);var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var o=t._component;o?C(o):e&&(e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),t.nextBase=e,u(e),function(t){var e=t.constructor.name;(M[e]||(M[e]=[])).push(t)}(t),v(e)),t.__ref&&t.__ref(null)}function w(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{}}function x(t){var e=t.filter,o=t.activeTodoCount,n=t.completedCount,r=t.clearCompleted;return o||n?lom_h("footer",{id:"footer"},lom_h("span",{id:"todo-activeTodoCount"},lom_h("strong",null,o)," ",function(t,e){return 1===t?e:e+"s"}(o,"item")," left"),lom_h("ul",{id:"filters"},lom_h("li",null,lom_h("a",{href:"./?todo_filter=all",className:{selected:e===G}},"All"))," ",lom_h("li",null,lom_h("a",{href:"./?todo_filter=active",className:{selected:e===q}},"Active"))," ",lom_h("li",null,lom_h("a",{href:"./?todo_filter=completed",className:{selected:e===Q}},"Completed"))),n>0?lom_h("button",{id:"clear-completed",onClick:r},"Clear completed"):null):null}function T(t){var e=t.toggleAll,o=t.activeTodoCount,n=t.filteredTodos,r=t.TodoItemView;return lom_h("section",{id:"main"},lom_h("input",{id:"toggle-all",type:"checkbox",onChange:e,checked:0===o}),lom_h("ul",{id:"todo-list"},n.map(function(t){return lom_h(r,{key:t.id,todo:t})})))}var k="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},N={},S=[],I=[],E="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,U=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,D=[],A=[],B=0,L=!1,P=!1,M={};n(w.prototype,{setState:function(t,e){var o=this.state;this.prevState||(this.prevState=n({},o)),n(o,"function"==typeof t?t(o,this.props):t),e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),r(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),b(this,2)},render:function(){}});var K=function(t){function e(e,o){var n;return n=t.call(this)||this,n._ns="app",n._location=e,n._history=o,n}o(e,t);var n=e.prototype;return n._params=function(){return new URLSearchParams(this._location.search)},n.location=function(t,e){var o=this._params();return void 0===e?o.get(t):(o.set(t,e),this._history.pushState(null,this._ns,"?"+o.toString()),e)},e}(function(){function t(){}return t.prototype.location=function(t,e){throw new Error("implement")},t}()),W=13,F=27,V="all",O="complete",j="active",H=function(){function t(t){void 0===t&&(t=new K(location,history)),this._locationStore=t}return t.prototype.filtered=function(t){switch(this.filter){case V:return t;case O:return t.filter(function(t){return!!t.completed});case j:return t.filter(function(t){return!t.completed});default:throw new Error("Unknown filter value: "+String(this.filter))}},e(t,[{key:"filter",get:function(){return this._locationStore.location("todo_filter")||V},set:function(t){return this._locationStore.location("todo_filter",t)}}]),t}(),R=function(){function t(t,e){var o=this;void 0===t&&(t={}),this.destroy=function(){o._store.remove(o.id)},this.toggle=function(){o.completed=!o.completed,o._store.saveTodo(o.toJSON())},this._title=t.title||"",this.id=t.id||function(){for(var t="",e=0;e<32;e++){var o=16*Math.random()|0;8!==e&&12!==e&&16!==e&&20!==e||(t+="-"),t+=(12===e?4:16===e?3&o|8:o).toString(16)}return t}(),this.completed=t.completed||!1,this._store=e}return t.prototype.toJSON=function(){return{completed:this.completed,title:this._title,id:this.id}},e(t,[{key:"title",get:function(){return this._title},set:function(t){this._title=t,this._store.saveTodo(this.toJSON())}}]),t}(),z=function(){function t(){var t=this;this.todos=[],this._todoFilter=new H,this.addTodo=function(e){var o=new R({title:e},t),n=t.todos.slice(0);n.push(o),t.todos=n,t.notify()},this.toggleAll=function(){var e=t.activeTodoCount>0;t.todos=t.todos.map(function(o,n){return new R({title:o.title,id:o.id,completed:e},t)}),t.notify()},this.clearCompleted=function(){for(var e=[],o=[],n=0;n<t.todos.length;n++){var r=t.todos[n];r.completed?o.push(r.id):e.push(r)}t.todos=e,t.notify()}}var o=t.prototype;return o.saveTodo=function(t){var e=this;this.todos=this.todos.map(function(o,n){return o.id===t.id?new R(t,e):o}),this.notify()},o.remove=function(t){this.todos=this.todos.filter(function(e){return e.id!==t}),this.notify()},e(t,[{key:"activeTodoCount",get:function(){return this.todos.reduce(function(t,e){return t+(e.completed?0:1)},0)}},{key:"completedCount",get:function(){return this.todos.length-this.activeTodoCount}},{key:"filter",get:function(){return this._todoFilter.filter}},{key:"filteredTodos",get:function(){return this._todoFilter.filtered(this.todos)}}]),t}(),J=function(t){function e(){for(var e,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=o=t.call.apply(t,[this].concat(r))||this,o.state={title:""},o.onInput=function(t){var e=t.target;o.setState({title:e.value})},o.onKeyDown=function(t){var e=o.state.title;if(t.keyCode===W&&e){t.preventDefault();var n=e.trim();n&&(o.props.addTodo(n),o.setState({title:""}))}},e||o}o(e,t);return e.prototype.render=function(){return function(t){var e=t.onInput,o=t.title,n=t.onKeyDown;return lom_h("header",{id:"header"},lom_h("h1",null,"todos"),lom_h("input",{id:"new-todo",placeholder:"What needs to be done?",onInput:e,value:o,onKeyDown:n,autoFocus:!0}))}({onInput:this.onInput,title:this.state.title,onKeyDown:this.onKeyDown})},e}(w),$=function(t){function e(){for(var e,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=o=t.call.apply(t,[this].concat(r))||this,o.state={editingId:null,editText:""},o.beginEdit=function(){o.setState({editText:o.props.todo.title,editingId:o.props.todo.id})},o.setFocus=function(t){t&&setTimeout(function(){return t.focus()},0)},o.setEditText=function(t){o.setState({editText:t.target.value})},o.cancel=function(){o.setState({editingId:null})},o.submit=function(){if(o.state.editingId){var t=o.state.editText;o.setState({editingId:null}),o.props.todo.title=t}},o.onKey=function(t){t.which===F?(t.preventDefault(),o.cancel()):t.which===W&&(t.preventDefault(),o.submit())},e||o}o(e,t);return e.prototype.render=function(){var t=this.props.todo,e=this.state;return function(t){var e=t.todo,o=t.editingId,n=t.toggle,r=t.destroy,i=t.beginEdit,l=t.setFocus,a=t.editText,s=t.setEditText,u=t.submit,c=t.onKey,d=o===e.id;return lom_h("li",{className:(e.completed?"completed ":" ")+(d?"editing":"")},lom_h("div",{className:"view"},lom_h("input",{className:"toggle",type:"checkbox",checked:e.completed||0,onClick:n}),lom_h("label",{onDblClick:i},e.title),lom_h("button",{className:"destroy",onClick:r})),d?lom_h("input",{ref:l,className:"edit",value:o&&a||e.title,onBlur:u,onInput:s,onKeyDown:c}):null)}({editingId:e.editingId,beginEdit:this.beginEdit,editText:e.editText,submit:this.submit,setEditText:this.setEditText,setFocus:this.setFocus,onKey:this.onKey,todo:t,destroy:t.destroy,toggle:t.toggle})},e}(w),G="all",q="active",Q="completed",X=function(t){function e(e,o){var n;return n=t.call(this,e,o)||this,e.todoService.notify=function(){return n.forceUpdate()},n}o(e,t);return e.prototype.render=function(){var t=this.props.todoService;return lom_h("div",null,lom_h(J,{addTodo:t.addTodo}),t.todos.length?lom_h(T,{toggleAll:t.toggleAll,activeTodoCount:t.activeTodoCount,filteredTodos:t.filteredTodos,TodoItemView:$}):null,lom_h(x,{activeTodoCount:t.activeTodoCount,completedCount:t.completedCount,filter:t.filter,clearCompleted:t.clearCompleted}))},e}(w),Y=new z;k.lom_h=function(t,e){var o,n,r,i,l=I;for(i=arguments.length;i-- >2;)S.push(arguments[i]);for(e&&null!=e.children&&(S.length||S.push(e.children),delete e.children);S.length;)if((n=S.pop())&&void 0!==n.pop)for(i=n.length;i--;)S.push(n[i]);else"boolean"==typeof n&&(n=null),(r="function"!=typeof t)&&(null==n?n="":"number"==typeof n?n=String(n):"string"!=typeof n&&(r=!1)),r&&o?l[l.length-1]+=n:l===I?l=[n]:l.push(n),o=r;var a=new function(){};return a.nodeName=t,a.children=l,a.attributes=null==e?void 0:e,a.key=null==e?void 0:e.key,void 0!==N.vnode&&N.vnode(a),a},function(t,e,o){f(o,t,{},!1,e,!1)}(lom_h(X,{todoService:Y}),function(){var t=document.getElementById("todoapp");if(!t)throw new Error("todoapp id not found in document");return t}())}();
//# sourceMappingURL=bundle.js.map
