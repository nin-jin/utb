!function(){"use strict";function t(){}function e(e,o){var n,r,i,l,a=O;for(l=arguments.length;l-- >2;)W.push(arguments[l]);for(o&&null!=o.children&&(W.length||W.push(o.children),delete o.children);W.length;)if((r=W.pop())&&void 0!==r.pop)for(l=r.length;l--;)W.push(r[l]);else"boolean"==typeof r&&(r=null),(i="function"!=typeof e)&&(null==r?r="":"number"==typeof r?r=String(r):"string"!=typeof r&&(i=!1)),i&&n?a[a.length-1]+=r:a===O?a=[r]:a.push(r),n=i;var s=new t;return s.nodeName=e,s.children=a,s.attributes=null==o?void 0:o,s.key=null==o?void 0:o.key,void 0!==D.vnode&&D.vnode(s),s}function o(t,e){for(var o in e)t[o]=e[o];return t}function n(t){!t._dirty&&(t._dirty=!0)&&1==K.push(t)&&(D.debounceRendering||V)(r)}function r(){var t,e=K;for(K=[];t=e.pop();)t._dirty&&x(t)}function i(t,e,o){return"string"==typeof e||"number"==typeof e?void 0!==t.splitText:"string"==typeof e.nodeName?!t._componentConstructor&&l(t,e.nodeName):o||t._componentConstructor===e.nodeName}function l(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function a(t){var e=o({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===e[r]&&(e[r]=n[r]);return e}function s(t,e){var o=e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);return o.normalizedNodeName=t,o}function c(t){var e=t.parentNode;e&&e.removeChild(t)}function u(t,e,o,n,r){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)o&&o(null),n&&n(t);else if("class"!==e||r)if("style"===e){if(n&&"string"!=typeof n&&"string"!=typeof o||(t.style.cssText=n||""),n&&"object"===P(n)){if("string"!=typeof o)for(var i in o)i in n||(t.style[i]="");for(var i in n)t.style[i]="number"==typeof n[i]&&!1===F.test(i)?n[i]+"px":n[i]}}else if("dangerouslySetInnerHTML"===e)n&&(t.innerHTML=n.__html||"");else if("o"==e[0]&&"n"==e[1]){var l=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),n?o||t.addEventListener(e,p,l):t.removeEventListener(e,p,l),(t._listeners||(t._listeners={}))[e]=n}else if("list"!==e&&"type"!==e&&!r&&e in t)d(t,e,null==n?"":n),null!=n&&!1!==n||t.removeAttribute(e);else{var a=r&&e!==(e=e.replace(/^xlink\:?/,""));null==n||!1===n?a?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof n&&(a?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),n):t.setAttribute(e,n))}else t.className=n||""}function d(t,e,o){try{t[e]=o}catch(t){}}function p(t){return this._listeners[t.type](D.event&&D.event(t)||t)}function f(){for(var t;t=H.pop();)D.afterMount&&D.afterMount(t),t.componentDidMount&&t.componentDidMount()}function h(t,e,o,n,r,i){j++||(R=null!=r&&void 0!==r.ownerSVGElement,z=null!=t&&!("__preactattr_"in t));var l=_(t,e,o,n,i);return r&&l.parentNode!==r&&r.appendChild(l),--j||(z=!1,i||f()),l}function _(t,e,o,n,r){var i=t,a=R;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||r)?t.nodeValue!=e&&(t.nodeValue=e):(i=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(i,t),v(t,!0))),i.__preactattr_=!0,i;var c=e.nodeName;if("function"==typeof c)return N(t,e,o,n);if(R="svg"===c||"foreignObject"!==c&&R,c=String(c),(!t||!l(t,c))&&(i=s(c,R),t)){for(;t.firstChild;)i.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(i,t),v(t,!0)}var u=i.firstChild,d=i.__preactattr_,p=e.children;if(null==d){d=i.__preactattr_={};for(var f=i.attributes,h=f.length;h--;)d[f[h].name]=f[h].value}return!z&&p&&1===p.length&&"string"==typeof p[0]&&null!=u&&void 0!==u.splitText&&null==u.nextSibling?u.nodeValue!=p[0]&&(u.nodeValue=p[0]):(p&&p.length||null!=u)&&m(i,p,o,n,z||null!=d.dangerouslySetInnerHTML),g(i,e.attributes,d),R=a,i}function m(t,e,o,n,r){var l,a,s,u,d,p=t.childNodes,f=[],h={},m=0,y=0,g=p.length,b=0,C=e?e.length:0;if(0!==g)for(N=0;N<g;N++){var w=p[N],S=w.__preactattr_;null!=(x=C&&S?w._component?w._component.__key:S.key:null)?(m++,h[x]=w):(S||(void 0!==w.splitText?!r||w.nodeValue.trim():r))&&(f[b++]=w)}if(0!==C)for(N=0;N<C;N++){d=null;var x=(u=e[N]).key;if(null!=x)m&&void 0!==h[x]&&(d=h[x],h[x]=void 0,m--);else if(!d&&y<b)for(l=y;l<b;l++)if(void 0!==f[l]&&i(a=f[l],u,r)){d=a,f[l]=void 0,l===b-1&&b--,l===y&&y++;break}d=_(d,u,o,n),s=p[N],d&&d!==t&&d!==s&&(null==s?t.appendChild(d):d===s.nextSibling?c(s):t.insertBefore(d,s))}if(m)for(var N in h)void 0!==h[N]&&v(h[N],!1);for(;y<=b;)void 0!==(d=f[b--])&&v(d,!1)}function v(t,e){var o=t._component;o?k(o):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||c(t),y(t))}function y(t){for(t=t.lastChild;t;){var e=t.previousSibling;v(t,!0),t=e}}function g(t,e,o){var n;for(n in o)e&&null!=e[n]||null==o[n]||u(t,n,o[n],o[n]=void 0,R);for(n in e)"children"===n||"innerHTML"===n||n in o&&e[n]===("value"===n||"checked"===n?t[n]:o[n])||u(t,n,o[n],o[n]=e[n],R)}function b(t){var e=t.constructor.name;(J[e]||(J[e]=[])).push(t)}function C(t,e,o){var n,r=J[t.name];if(t.prototype&&t.prototype.render?(n=new t(e,o),T.call(n,e,o)):((n=new T(e,o)).constructor=t,n.render=w),r)for(var i=r.length;i--;)if(r[i].constructor===t){n.nextBase=r[i].nextBase,r.splice(i,1);break}return n}function w(t,e,o){return this.constructor(t,o)}function S(t,e,o,r,i){t._disable||(t._disable=!0,(t.__ref=e.ref)&&delete e.ref,(t.__key=e.key)&&delete e.key,!t.base||i?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r),r&&r!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=r),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==o&&(1!==o&&!1===D.syncComponentUpdates&&t.base?n(t):x(t,1,i)),t.__ref&&t.__ref(t))}function x(t,e,n,r){if(!t._disable){var i,l,s,c=t.props,u=t.state,d=t.context,p=t.prevProps||c,_=t.prevState||u,m=t.prevContext||d,y=t.base,g=t.nextBase,b=y||g,w=t._component,N=!1;if(y&&(t.props=p,t.state=_,t.context=m,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(c,u,d)?N=!0:t.componentWillUpdate&&t.componentWillUpdate(c,u,d),t.props=c,t.state=u,t.context=d),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!N){i=t.render(c,u,d),t.getChildContext&&(d=o(o({},d),t.getChildContext()));var T,L,E=i&&i.nodeName;if("function"==typeof E){var U=a(i);(l=w)&&l.constructor===E&&U.key==l.__key?S(l,U,1,d,!1):(T=l,t._component=l=C(E,U,d),l.nextBase=l.nextBase||g,l._parentComponent=t,S(l,U,0,d,!1),x(l,1,n,!0)),L=l.base}else s=b,(T=w)&&(s=t._component=null),(b||1===e)&&(s&&(s._component=null),L=h(s,i,d,n||!y,b&&b.parentNode,!0));if(b&&L!==b&&l!==w){var A=b.parentNode;A&&L!==A&&(A.replaceChild(L,b),T||(b._component=null,v(b,!1)))}if(T&&k(T),t.base=L,L&&!r){for(var I=t,P=t;P=P._parentComponent;)(I=P).base=L;L._component=I,L._componentConstructor=I.constructor}}if(!y||n?H.unshift(t):N||(t.componentDidUpdate&&t.componentDidUpdate(p,_,m),D.afterUpdate&&D.afterUpdate(t)),null!=t._renderCallbacks)for(;t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);j||r||f()}}function N(t,e,o,n){for(var r=t&&t._component,i=r,l=t,s=r&&t._componentConstructor===e.nodeName,c=s,u=a(e);r&&!c&&(r=r._parentComponent);)c=r.constructor===e.nodeName;return r&&c&&(!n||r._component)?(S(r,u,3,o,n),t=r.base):(i&&!s&&(k(i),t=l=null),r=C(e.nodeName,u,o),t&&!r.nextBase&&(r.nextBase=t,l=null),S(r,u,1,o,n),t=r.base,l&&t!==l&&(l._component=null,v(l,!1))),t}function k(t){D.beforeUnmount&&D.beforeUnmount(t);var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var o=t._component;o?k(o):e&&(e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),t.nextBase=e,c(e),b(t),y(e)),t.__ref&&t.__ref(null)}function T(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{}}function L(t,e,o){return h(o,t,{},!1,e,!1)}function E(){for(var t="",e=0;e<32;e++){var o=16*Math.random()|0;8!==e&&12!==e&&16!==e&&20!==e||(t+="-"),t+=(12===e?4:16===e?3&o|8:o).toString(16)}return t}function U(t,e){return 1===t?e:e+"s"}function A({nowShowing:t,count:e,completedCount:o,onClearCompleted:n}){return lom_h("footer",{id:"footer"},lom_h("span",{id:"todo-count"},lom_h("strong",null,e)," ",U(e,"item")," left"),lom_h("ul",{id:"filters"},lom_h("li",null,lom_h("a",{href:"./?todo_filter=all",className:{selected:t===et}},"All"))," ",lom_h("li",null,lom_h("a",{href:"./?todo_filter=active",className:{selected:t===ot}},"Active"))," ",lom_h("li",null,lom_h("a",{href:"./?todo_filter=completed",className:{selected:t===nt}},"Completed"))),o>0?lom_h("button",{id:"clear-completed",onClick:n},"Clear completed"):null)}var I="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),B=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e};t._r=[2];var D={},W=[],O=[];e._r=[2],o._r=[2];var V="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,F=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,K=[];n._r=[2],r._r=[2],i._r=[2],l._r=[2],a._r=[2],s._r=[2],c._r=[2],u._r=[2],d._r=[2],p._r=[2];var H=[],j=0,R=!1,z=!1;f._r=[2],h._r=[2],_._r=[2],m._r=[2],v._r=[2],y._r=[2],g._r=[2];var J={};b._r=[2],C._r=[2],w._r=[2],S._r=[2],x._r=[2],N._r=[2],k._r=[2],T._r=[2],o(T.prototype,{setState:function(t,e){var r=this.state;this.prevState||(this.prevState=o({},r)),o(r,"function"==typeof t?t(r,this.props):t),e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),n(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),x(this,2)},render:function(){}}),L._r=[2],E._r=[2],U._r=[2,[Number,String]];var $=function(){function t(){}return t.prototype.location=function(t,e,o){throw new Error("implement")},t}(),G=function(t){function e(e,o){var n;return n=t.call(this)||this,n._location=void 0,n._history=void 0,n._ns="lom_app",n._location=e,n._history=o,n}B(e,t);var o=e.prototype;return o._params=function(){return new URLSearchParams(this._location.search)},o.location=function(t,e,o){var n=this._params();return void 0===e?n.get(t):(n.set(t,e),this._history.pushState(null,this._ns,"?"+n.toString()),e)},e}($);G._r=[0,[Location,History]];var q=function(){function t(t,e){var o=this;void 0===t&&(t={}),this.completed=void 0,this._title=void 0,this.id=void 0,this._store=void 0,this.destroy=function(){o._store.remove(o.id)},this.toggle=function(){o.completed=!o.completed,o._store.saveTodo(o.toJSON())},this._title=t.title||"",this.id=t.id||E(),this.completed=t.completed||!1,this._store=e}return t.prototype.toJSON=function(){return{completed:this.completed,title:this._title,id:this.id}},M(t,[{key:"title",get:function(){return this._title},set:function(t){this._title=t,this._store.saveTodo(this.toJSON())}}]),t}();q._r=[0,[Q]];var Q=function(){function t(){var t=this;this.todos=[],this.notify=void 0,this.toggleAll=function(){var e=t.activeTodoCount>0;t.todos=t.todos.map(function(o,n){return new q({title:o.title,id:o.id,completed:e},t)}),t.notify()},this.clearCompleted=function(){for(var e=[],o=[],n=0;n<t.todos.length;n++){var r=t.todos[n];r.completed?o.push(r.id):e.push(r)}t.todos=e,t.notify()}}var e=t.prototype;return e.addTodo=function(t){var e=new q({title:t},this),o=this.todos.slice(0);o.push(e),this.todos=o,this.notify()},e.saveTodo=function(t){var e=this;this.todos=this.todos.map(function(o,n){return o.id===t.id?new q(t,e):o}),this.notify()},e.remove=function(t){this.todos=this.todos.filter(function(e){return e.id!==t}),this.notify()},M(t,[{key:"activeTodoCount",get:function(){return this.todos.reduce(function(t,e){return t+(e.completed?0:1)},0)}},{key:"completedCount",get:function(){return this.todos.length-this.activeTodoCount}}]),t}(),X={ALL:"all",COMPLETE:"complete",ACTIVE:"active"},Y=function(){function t(t,e){this._todoService=void 0,this._locationStore=void 0,this._todoService=t,this._locationStore=e}return M(t,[{key:"filter",get:function(){return this._locationStore.location("todo_filter")||X.ALL},set:function(t){return this._locationStore.location("todo_filter",t)}},{key:"filteredTodos",get:function(){var t=this._todoService.todos;switch(this.filter){case X.ALL:return t;case X.COMPLETE:return t.filter(function(t){return!!t.completed});case X.ACTIVE:return t.filter(function(t){return!t.completed});default:throw new Error("Unknown filter value: "+this.filter)}}}]),t}();Y._r=[0,[Q,$]];var Z=13,tt=function(t){function e(){for(var e,o,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=o=t.call.apply(t,[this].concat(r))||this,o.state={title:""},o.onInput=function({target:t}){o.setState({title:t.value})},o.onKeyDown=function(t){var e=o.state.title;if(t.keyCode===Z&&e){t.preventDefault();var n=e.trim();n&&(o.props.todoService.addTodo(n),o.setState({title:""}))}},e||o}return B(e,t),e.prototype.render=function(){return lom_h("header",{id:"header"},lom_h("h1",null,"todos"),lom_h("input",{id:"new-todo",placeholder:"What needs to be done?",onInput:this.onInput,value:this.state.title,onKeyDown:this.onKeyDown,autoFocus:!0}))},e}(T),et="all",ot="active",nt="completed";A._r=[1];var rt=27,it=13,lt=function(t){function e(){for(var e,o,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=o=t.call.apply(t,[this].concat(r))||this,o.state={editingId:null,editText:""},o.beginEdit=function(){o.setState({editText:o.props.todo.title,editingId:o.props.todo.id})},o.setFocus=function(t){t&&setTimeout(function(){return t.focus()},0)},o.setEditText=function(t){o.setState({editText:t.target.value})},o.cancel=function(){o.setState({editingId:null})},o.submit=function(){if(o.state.editingId){var t=o.state.editText;o.setState({editingId:null}),o.props.todo.title=t}},o.onKey=function(t){t.which===rt?(t.preventDefault(),o.cancel()):t.which===it&&(t.preventDefault(),o.submit())},e||o}return B(e,t),e.prototype.render=function(){var t=this.props.todo,e=this.state.editingId===t.id;return lom_h("li",{className:(t.completed?"completed ":" ")+(e?"editing":"")},lom_h("div",{className:"view"},lom_h("input",{className:"toggle",type:"checkbox",checked:t.completed||0,onClick:t.toggle}),lom_h("label",{onDblClick:this.beginEdit},t.title),lom_h("button",{className:"destroy",onClick:t.destroy})),e?lom_h("input",{ref:this.setFocus,className:"edit",value:this.state.editingId&&this.state.editText||t.title,onBlur:this.submit,onInput:this.setEditText,onKeyDown:this.onKey}):null)},e}(T),at=function(t){function e(e,o){var n;return n=t.call(this,e,o)||this,e.todoService.notify=function(){return n.forceUpdate()},n}return B(e,t),e.prototype.render=function(){var t=this.props,e=t.todoService,o=t.todoFilterService,n=e.todos;return lom_h("div",null,lom_h(tt,{todoService:e}),n.length?lom_h("section",{id:"main"},lom_h("input",{id:"toggle-all",type:"checkbox",onChange:e.toggleAll,checked:0===e.activeTodoCount}),lom_h("ul",{id:"todo-list"},o.filteredTodos.map(function(t){return lom_h(lt,{key:t.id,todo:t})}))):null,e.activeTodoCount||e.completedCount?lom_h(A,{count:e.activeTodoCount,completedCount:e.completedCount,nowShowing:o.filter,onClearCompleted:e.clearCompleted}):null)},e}(T);at._r=[0,[{todoService:Q,todoFilterService:Y}]];var st=new Q,ct=new Y(st,new G(location,history));I.lom_h=e,L(lom_h(at,{todoService:st,todoFilterService:ct}),document.getElementById("todoapp"))}();
//# sourceMappingURL=bundle.js.map
